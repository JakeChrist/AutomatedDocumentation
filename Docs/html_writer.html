<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>html_writer</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul>
        <li><a href="index.html"><strong>üè† Project Overview</strong></a></li>
<li><a href="cache.html">cache</a></li>
<li><a href="docgenerator.html">docgenerator</a></li>
<li><a href="html_writer.html">html_writer</a></li>
<li><a href="llm_client.html">llm_client</a></li>
<li><a href="parser_matlab.html">parser_matlab</a></li>
<li><a href="parser_python.html">parser_python</a></li>
<li><a href="reviewer.html">reviewer</a></li>
<li><a href="scanner.html">scanner</a></li>
<li><a href="test_cache.html">test_cache</a></li>
<li><a href="test_docgenerator.html">test_docgenerator</a></li>
<li><a href="test_html_writer.html">test_html_writer</a></li>
<li><a href="test_integration.html">test_integration</a></li>
<li><a href="test_llm_client.html">test_llm_client</a></li>
<li><a href="test_parser_matlab.html">test_parser_matlab</a></li>
<li><a href="test_parser_python.html">test_parser_python</a></li>
<li><a href="test_reviewer.html">test_reviewer</a></li>
<li><a href="test_scanner.html">test_scanner</a></li>
        </ul>
    </div>
    <div class="content">
        <h1>html_writer</h1>
        <p>This module provides utilities for rendering HTML documentation pages using simple template substitution. It includes functions to highlight code snippets and render HTML content based on project summaries and module data. The `write_index` function generates the main index page with project summary and navigation links. The `write_module_page` function creates detailed documentation pages for individual modules, including classes, methods, and functions, with syntax highlighting for source code.</p>
<h2>Functions</h2>
<h3 id="_highlight">_highlight(code: str, language: str) -&gt; str</h3>
<p>The function `_highlight` takes a string `code` and a string `language`, and returns the code highlighted for the specified language using Pygments. If the language is &quot;matlab&quot;, it uses the MatlabLexer; if &quot;python&quot;, it uses the PythonLexer; otherwise, it uses the TextLexer. The output is formatted as HTML with `&lt;pre&gt;` and `&lt;code&gt;` tags, and syntax highlighting applied.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_highlight</span>(code: <span style="color: #008000">str</span>, language: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Return ``code`` highlighted for ``language`` using pygments.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">if</span> language<span style="color: #666666">.</span>lower() <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;matlab&quot;</span>:
        lexer <span style="color: #666666">=</span> MatlabLexer()
    <span style="color: #008000; font-weight: bold">elif</span> language<span style="color: #666666">.</span>lower() <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;python&quot;</span>:
        lexer <span style="color: #666666">=</span> PythonLexer()
    <span style="color: #008000; font-weight: bold">else</span>:
        lexer <span style="color: #666666">=</span> TextLexer()
    formatter <span style="color: #666666">=</span> HtmlFormatter(noclasses<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>, nowrap<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
    highlighted <span style="color: #666666">=</span> highlight(code, lexer, formatter)
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">f&quot;&lt;pre&gt;&lt;code&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>highlighted<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/code&gt;&lt;/pre&gt;&quot;</span>
</code></pre>
<h3 id="_render_html">_render_html(title: str, header: str, body: str, nav_html: str) -&gt; str</h3>
<p>This function `_render_html` takes four parameters: `title`, `header`, `body`, and `nav_html`. It reads a template from a file specified by `_TEMPLATE_PATH`, which is expected to be in UTF-8 encoding. The function then formats this template using the provided title, header, body, and navigation HTML, and returns the resulting HTML string.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_render_html</span>(title: <span style="color: #008000">str</span>, header: <span style="color: #008000">str</span>, body: <span style="color: #008000">str</span>, nav_html: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
    template <span style="color: #666666">=</span> _TEMPLATE_PATH<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">&quot;utf-8&quot;</span>)
    <span style="color: #008000; font-weight: bold">return</span> template<span style="color: #666666">.</span>format(
        title<span style="color: #666666">=</span>title,
        header<span style="color: #666666">=</span>header,
        body<span style="color: #666666">=</span>body,
        navigation<span style="color: #666666">=</span>nav_html,
        static_path<span style="color: #666666">=</span><span style="color: #BA2121">&quot;static/style.css&quot;</span>,
    )
</code></pre>
<h3 id="write_index">write_index(output_dir: str, project_summary: str, page_links: Iterable[Tuple[str, str]], module_summaries: Dict[str, str] | None=None) -&gt; None</h3>
<p>This function `write_index` generates the content for an `index.html` file in a specified output directory. It takes parameters for the project summary, navigation links, and optional module summaries. The function creates the destination directory if it doesn&#x27;t exist, constructs HTML elements for the project summary and navigation links, and optionally includes summaries of modules. It then renders these elements into a complete HTML document using `_render_html` and writes this document to `index.html` in the output directory.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">write_index</span>(
    output_dir: <span style="color: #008000">str</span>,
    project_summary: <span style="color: #008000">str</span>,
    page_links: Iterable[Tuple[<span style="color: #008000">str</span>, <span style="color: #008000">str</span>]],
    module_summaries: Dict[<span style="color: #008000">str</span>, <span style="color: #008000">str</span>] <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>,
) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Render ``index.html`` with *project_summary* and navigation links.&quot;&quot;&quot;</span>
    dest_dir <span style="color: #666666">=</span> Path(output_dir)
    dest_dir<span style="color: #666666">.</span>mkdir(parents<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>, exist_ok<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
    nav_html <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>join(
        <span style="color: #BA2121">f&#39;&lt;li&gt;&lt;a href=&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>link<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(text)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/a&gt;&lt;/li&gt;&#39;</span>
        <span style="color: #008000; font-weight: bold">for</span> text, link <span style="color: #AA22FF; font-weight: bold">in</span> page_links
    )
    body_parts <span style="color: #666666">=</span> [<span style="color: #BA2121">f&quot;&lt;p&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(project_summary)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/p&gt;&quot;</span>, <span style="color: #BA2121">&quot;&lt;hr/&gt;&quot;</span>, <span style="color: #BA2121">&quot;&lt;h2&gt;Modules&lt;/h2&gt;&quot;</span>]

    module_items: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []
    <span style="color: #008000; font-weight: bold">for</span> text, link <span style="color: #AA22FF; font-weight: bold">in</span> page_links:
        summary <span style="color: #666666">=</span> (module_summaries <span style="color: #AA22FF; font-weight: bold">or</span> {})<span style="color: #666666">.</span>get(text, <span style="color: #BA2121">&quot;&quot;</span>)
        item <span style="color: #666666">=</span> (
            <span style="color: #BA2121">f&#39;&lt;li style=&quot;margin-bottom: 1em;&quot;&gt;&#39;</span>
            <span style="color: #BA2121">f&#39;&lt;a href=&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>link<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(text)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/a&gt;&#39;</span>
        )
        <span style="color: #008000; font-weight: bold">if</span> summary:
            item <span style="color: #666666">+=</span> <span style="color: #BA2121">f&quot;&lt;br/&gt;&lt;small&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(summary)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/small&gt;&quot;</span>
        item <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;&lt;/li&gt;&quot;</span>
        module_items<span style="color: #666666">.</span>append(item)

    <span style="color: #008000; font-weight: bold">if</span> module_items:
        body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">&#39;&lt;ul style=&quot;list-style-type: none; padding-left: 0;&quot;&gt;&#39;</span>)
        body_parts<span style="color: #666666">.</span>extend(module_items)
        body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">&quot;&lt;/ul&gt;&quot;</span>)

    body <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>join(body_parts)
    html_out <span style="color: #666666">=</span> _render_html(
        <span style="color: #BA2121">&quot;Project Documentation&quot;</span>, <span style="color: #BA2121">&quot;Project Documentation&quot;</span>, body, nav_html
    )
    (dest_dir <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;index.html&quot;</span>)<span style="color: #666666">.</span>write_text(html_out, encoding<span style="color: #666666">=</span><span style="color: #BA2121">&quot;utf-8&quot;</span>)
</code></pre>
<h3 id="write_module_page">write_module_page(output_dir: str, module_data: dict[str, Any], page_links: Iterable[Tuple[str, str]]) -&gt; None</h3>
<p>This function `write_module_page` generates an HTML documentation page for a Python or MATLAB module. It takes three parameters: the output directory (`output_dir`), a dictionary containing module data (`module_data`), and an iterable of tuples representing navigation links (`page_links`). The function creates a directory structure if it doesn&#x27;t exist, constructs a navigation menu, and populates the body with summaries, classes, methods, and functions from the module data. It uses HTML escaping to ensure safe rendering and includes syntax highlighting for code snippets. Finally, it writes the generated HTML content to a file named after the module in the specified output directory.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">write_module_page</span>(output_dir: <span style="color: #008000">str</span>, module_data: <span style="color: #008000">dict</span>[<span style="color: #008000">str</span>, Any], page_links: Iterable[Tuple[<span style="color: #008000">str</span>, <span style="color: #008000">str</span>]]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Render a module documentation page using ``module_data``.&quot;&quot;&quot;</span>
    dest_dir <span style="color: #666666">=</span> Path(output_dir)
    dest_dir<span style="color: #666666">.</span>mkdir(parents<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>, exist_ok<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
    module_name <span style="color: #666666">=</span> module_data<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;name&quot;</span>, <span style="color: #BA2121">&quot;module&quot;</span>)
    language <span style="color: #666666">=</span> module_data<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;language&quot;</span>, <span style="color: #BA2121">&quot;python&quot;</span>)
    nav_items <span style="color: #666666">=</span> [
        <span style="color: #BA2121">&#39;&lt;li&gt;&lt;a href=&quot;index.html&quot;&gt;&lt;strong&gt;üè† Project Overview&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#39;</span>
    ]
    nav_items<span style="color: #666666">.</span>extend(
        <span style="color: #BA2121">f&#39;&lt;li&gt;&lt;a href=&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>link<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(text)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/a&gt;&lt;/li&gt;&#39;</span>
        <span style="color: #008000; font-weight: bold">for</span> text, link <span style="color: #AA22FF; font-weight: bold">in</span> page_links
    )
    nav_html <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>join(nav_items)

    body_parts <span style="color: #666666">=</span> [<span style="color: #BA2121">f&quot;&lt;p&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(module_data<span style="color: #666666">.</span>get(<span style="color: #BA2121">&#39;summary&#39;</span>,<span style="color: #bbbbbb"> </span><span style="color: #BA2121">&#39;&#39;</span>))<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/p&gt;&quot;</span>]

    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">cls</span> <span style="color: #AA22FF; font-weight: bold">in</span> module_data<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;classes&quot;</span>, []):
        cls_name <span style="color: #666666">=</span> <span style="color: #008000">cls</span><span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;name&quot;</span>, <span style="color: #BA2121">&quot;&quot;</span>)
        body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&#39;&lt;h2 id=&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>cls_name<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;&gt;Class: </span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(cls_name)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/h2&gt;&#39;</span>)
        doc <span style="color: #666666">=</span> <span style="color: #008000">cls</span><span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;docstring&quot;</span>) <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #008000">cls</span><span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;summary&quot;</span>)
        <span style="color: #008000; font-weight: bold">if</span> doc:
            body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;&lt;p&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(doc)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/p&gt;&quot;</span>)
        <span style="color: #008000; font-weight: bold">for</span> method <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">cls</span><span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;methods&quot;</span>, []):
            sig <span style="color: #666666">=</span> method<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;signature&quot;</span>) <span style="color: #AA22FF; font-weight: bold">or</span> method<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;name&quot;</span>, <span style="color: #BA2121">&quot;&quot;</span>)
            body_parts<span style="color: #666666">.</span>append(
                <span style="color: #BA2121">f&#39;&lt;h3 id=&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>method<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;name&quot;</span>)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;&gt;Method: </span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(sig)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/h3&gt;&#39;</span>
            )
            <span style="color: #008000; font-weight: bold">if</span> method<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;docstring&quot;</span>):
                body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&#39;&lt;p&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(method[<span style="color: #BA2121">&quot;docstring&quot;</span>])<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/p&gt;&#39;</span>)
            src <span style="color: #666666">=</span> method<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;source&quot;</span>)
            <span style="color: #008000; font-weight: bold">if</span> src:
                body_parts<span style="color: #666666">.</span>append(_highlight(src, language))

    <span style="color: #008000; font-weight: bold">if</span> module_data<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;functions&quot;</span>):
        body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">&quot;&lt;h2&gt;Functions&lt;/h2&gt;&quot;</span>)
    <span style="color: #008000; font-weight: bold">for</span> func <span style="color: #AA22FF; font-weight: bold">in</span> module_data<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;functions&quot;</span>, []):
        sig <span style="color: #666666">=</span> func<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;signature&quot;</span>) <span style="color: #AA22FF; font-weight: bold">or</span> func<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;name&quot;</span>, <span style="color: #BA2121">&quot;&quot;</span>)
        body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&#39;&lt;h3 id=&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>func<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;name&quot;</span>)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(sig)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/h3&gt;&#39;</span>)
        summary <span style="color: #666666">=</span> func<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;summary&quot;</span>)
        <span style="color: #008000; font-weight: bold">if</span> summary:
            body_parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;&lt;p&gt;</span><span style="color: #A45A77; font-weight: bold">{</span>html<span style="color: #666666">.</span>escape(summary)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&lt;/p&gt;&quot;</span>)
        src <span style="color: #666666">=</span> func<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;source&quot;</span>)
        <span style="color: #008000; font-weight: bold">if</span> src:
            body_parts<span style="color: #666666">.</span>append(_highlight(src, language))

    body <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>join(body_parts)
    html_out <span style="color: #666666">=</span> _render_html(
        html<span style="color: #666666">.</span>escape(module_name),
        html<span style="color: #666666">.</span>escape(module_name),
        body,
        nav_html,
    )
    (dest_dir <span style="color: #666666">/</span> <span style="color: #BA2121">f&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>module_name<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">.html&quot;</span>)<span style="color: #666666">.</span>write_text(html_out, encoding<span style="color: #666666">=</span><span style="color: #BA2121">&quot;utf-8&quot;</span>)
</code></pre>
    </div>
</body>
</html>
