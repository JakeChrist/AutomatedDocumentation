<!-- Generated by DocGen-LM -->
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>test_integration</title>
<link href="static/style.css" rel="stylesheet"/>
</head>
<body><a class="skip-link" href="#main-content">Skip to main content</a><header class="topbar"><button aria-label="Toggle navigation menu" id="sidebar-toggle">Menu</button><span class="topbar-title">test_integration</span></header>
<nav aria-label="Documentation navigation" class="sidebar">
<h2>Navigation</h2>
<ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><a href="cache.html">cache</a></li><li><a href="chunk_utils.html">chunk_utils</a></li><li><a href="docgenerator.html">docgenerator</a></li><li><a href="explaincode.html">explaincode</a></li><li><a href="gui_wrapper.html">gui_wrapper</a></li><li><a href="html_writer.html">html_writer</a></li><li><a href="llm_client.html">llm_client</a></li><li><a href="manual_utils.html">manual_utils</a></li><li><a href="parser_cpp.html">parser_cpp</a></li><li><a href="parser_java.html">parser_java</a></li><li><a href="parser_matlab.html">parser_matlab</a></li><li><a href="parser_python.html">parser_python</a></li><li><a href="retrofit_sidebar.html">retrofit_sidebar</a></li><li><a href="reviewer.html">reviewer</a></li><li><a href="sanitize_docs.html">sanitize_docs</a></li><li><a href="scanner.html">scanner</a></li><li><a href="setup.html">setup</a></li><li><a href="summarize_utils.html">summarize_utils</a></li><li><details><summary>tests</summary><ul><li><a href="test_cache.html">test_cache</a></li><li><a href="test_chunk_utils.html">test_chunk_utils</a></li><li><a href="test_docgenerator.html">test_docgenerator</a></li><li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li><li><a href="test_explaincode.html">test_explaincode</a></li><li><a href="test_html_writer.html">test_html_writer</a></li><li><a href="test_integration.html">test_integration</a></li><li><a href="test_llm_client.html">test_llm_client</a></li><li><a href="test_manual_utils.html">test_manual_utils</a></li><li><a href="test_parser_cpp.html">test_parser_cpp</a></li><li><a href="test_parser_java.html">test_parser_java</a></li><li><a href="test_parser_matlab.html">test_parser_matlab</a></li><li><a href="test_parser_python.html">test_parser_python</a></li><li><a href="test_resume_progress.html">test_resume_progress</a></li><li><a href="test_retrofit_sidebar.html">test_retrofit_sidebar</a></li><li><a href="test_reviewer.html">test_reviewer</a></li><li><a href="test_sanitize_docs.html">test_sanitize_docs</a></li><li><a href="test_scanner.html">test_scanner</a></li></ul></details></li></ul>
</nav>
<main class="content" id="main-content" role="main">
<h1>test_integration</h1>
<p>Module defines tests for the `docgenerator` tool, verifying HTML generation from code files in multiple languages including Python, MATLAB, C++, and Java. Tests check that output HTML files are created with expected content and that static assets like CSS are copied correctly regardless of current working directory. The tests mock an LLM client to simulate documentation generation without external dependencies.</p>
<h2>Functions</h2>
<h3 id="test_docgenerator_generates_html">test_docgenerator_generates_html(tmp_path: Path) -&gt; None</h3>
<p>This function tests the HTML documentation generation capability of the DocGen-LM tool. It creates a temporary project directory containing sample source files in Python, MATLAB, C++, and Java, then invokes the main documentation generation function with mocked LLM client behavior. The test verifies that the tool successfully generates HTML output files for each source file, ensuring that the generated content includes the expected summary text from the mocked language model. The test confirms the tool's ability to process multiple programming languages and produce structured HTML documentation with embedded summaries.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_docgenerator_generates_html</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    project_dir <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">"project"</span>
    project_dir<span style="color: #666666">.</span>mkdir()
    <span style="color: #3D7B7B; font-style: italic"># simple python file</span>
    (project_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"hello.py"</span>)<span style="color: #666666">.</span>write_text(<span style="color: #BA2121">'def hi():</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">    """Say hi."""</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">    return "hi"</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">'</span>)
    <span style="color: #3D7B7B; font-style: italic"># simple matlab file</span>
    (project_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"util.m"</span>)<span style="color: #666666">.</span>write_text(<span style="color: #BA2121">'</span><span style="color: #A45A77; font-weight: bold">% u</span><span style="color: #BA2121">til function</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">function y = util(x)</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121"> y = x;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">end</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">'</span>)
    <span style="color: #3D7B7B; font-style: italic"># simple C++ file</span>
    (project_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"math.cpp"</span>)<span style="color: #666666">.</span>write_text(
        <span style="color: #BA2121">"/** Add numbers */</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">int add(int a, int b) {</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">    return a + b;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">}</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
    )
    <span style="color: #3D7B7B; font-style: italic"># simple Java file</span>
    (project_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"Greeter.java"</span>)<span style="color: #666666">.</span>write_text(
        <span style="color: #BA2121">"/** Example package */</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"package demo;</span><span style="color: #AA5D1F; font-weight: bold">\n\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"/** Greeter class */</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"public class Greeter {</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"    /** say hi */</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"    public String greet() {</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"        return </span><span style="color: #AA5D1F; font-weight: bold">\"</span><span style="color: #BA2121">hi</span><span style="color: #AA5D1F; font-weight: bold">\"</span><span style="color: #BA2121">;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"    }</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
        <span style="color: #BA2121">"}</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>
    )

    output_dir <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">"out"</span>

    <span style="color: #008000; font-weight: bold">with</span> patch(<span style="color: #BA2121">"docgenerator.LLMClient"</span>) <span style="color: #008000; font-weight: bold">as</span> MockClient:
        instance <span style="color: #666666">=</span> MockClient<span style="color: #666666">.</span>return_value
        instance<span style="color: #666666">.</span>ping<span style="color: #666666">.</span>return_value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        instance<span style="color: #666666">.</span>summarize<span style="color: #666666">.</span>return_value <span style="color: #666666">=</span> <span style="color: #BA2121">"summary"</span>
        ret <span style="color: #666666">=</span> main([<span style="color: #008000">str</span>(project_dir), <span style="color: #BA2121">"--output"</span>, <span style="color: #008000">str</span>(output_dir)])
        <span style="color: #008000; font-weight: bold">assert</span> ret <span style="color: #666666">==</span> <span style="color: #666666">0</span>

    <span style="color: #3D7B7B; font-style: italic"># verify html files created</span>
    <span style="color: #008000; font-weight: bold">assert</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"index.html"</span>)<span style="color: #666666">.</span>exists()
    <span style="color: #008000; font-weight: bold">assert</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"hello.html"</span>)<span style="color: #666666">.</span>exists()
    <span style="color: #008000; font-weight: bold">assert</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"util.html"</span>)<span style="color: #666666">.</span>exists()
    <span style="color: #008000; font-weight: bold">assert</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"math.html"</span>)<span style="color: #666666">.</span>exists()
    <span style="color: #008000; font-weight: bold">assert</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"Greeter.html"</span>)<span style="color: #666666">.</span>exists()

    html <span style="color: #666666">=</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"hello.html"</span>)<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">"utf-8"</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">"summary"</span> <span style="color: #AA22FF; font-weight: bold">in</span> html
    cpp_html <span style="color: #666666">=</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"math.html"</span>)<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">"utf-8"</span>)
    java_html <span style="color: #666666">=</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"Greeter.html"</span>)<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">"utf-8"</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">"summary"</span> <span style="color: #AA22FF; font-weight: bold">in</span> cpp_html
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">"summary"</span> <span style="color: #AA22FF; font-weight: bold">in</span> java_html
</code></pre>
<h3 id="test_static_copied_from_any_cwd">test_static_copied_from_any_cwd(tmp_path: Path, monkeypatch) -&gt; None</h3>
<p>The function `test_static_copied_from_any_cwd` is a test case that verifies the copying of static assets, specifically `style.css`, to the output directory regardless of the current working directory. It creates a temporary project structure with a Python module, sets up a mock LLM client to simulate successful ping and summarize operations, changes the working directory to the temporary path, and executes the main documentation generation function with specified input and output paths. The test confirms that the `style.css` file is present in the expected location within the output directory after execution.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_static_copied_from_any_cwd</span>(tmp_path: Path, monkeypatch) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    project_dir <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">"proj"</span>
    project_dir<span style="color: #666666">.</span>mkdir()
    (project_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"mod.py"</span>)<span style="color: #666666">.</span>write_text(<span style="color: #BA2121">"pass</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span>)

    output_dir <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">"docs"</span>

    <span style="color: #008000; font-weight: bold">with</span> patch(<span style="color: #BA2121">"docgenerator.LLMClient"</span>) <span style="color: #008000; font-weight: bold">as</span> MockClient:
        instance <span style="color: #666666">=</span> MockClient<span style="color: #666666">.</span>return_value
        instance<span style="color: #666666">.</span>ping<span style="color: #666666">.</span>return_value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        instance<span style="color: #666666">.</span>summarize<span style="color: #666666">.</span>return_value <span style="color: #666666">=</span> <span style="color: #BA2121">"summary"</span>
        monkeypatch<span style="color: #666666">.</span>chdir(tmp_path)
        ret <span style="color: #666666">=</span> main([<span style="color: #008000">str</span>(project_dir), <span style="color: #BA2121">"--output"</span>, <span style="color: #008000">str</span>(output_dir)])
        <span style="color: #008000; font-weight: bold">assert</span> ret <span style="color: #666666">==</span> <span style="color: #666666">0</span>

    <span style="color: #008000; font-weight: bold">assert</span> (output_dir <span style="color: #666666">/</span> <span style="color: #BA2121">"static"</span> <span style="color: #666666">/</span> <span style="color: #BA2121">"style.css"</span>)<span style="color: #666666">.</span>exists()
</code></pre>
</main>
<footer aria-label="Page footer" class="page-footer"><p>Generated documentation</p></footer><script src="static/toggle.js"></script>
</body>
</html>
