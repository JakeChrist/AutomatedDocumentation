<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>test_reviewer</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul>
        <li><a href="index.html"><strong>üè† Project Overview</strong></a></li>
<li><a href="cache.html">cache</a></li>
<li><a href="docgenerator.html">docgenerator</a></li>
<li><a href="html_writer.html">html_writer</a></li>
<li><a href="llm_client.html">llm_client</a></li>
<li><a href="parser_matlab.html">parser_matlab</a></li>
<li><a href="parser_python.html">parser_python</a></li>
<li><a href="reviewer.html">reviewer</a></li>
<li><a href="scanner.html">scanner</a></li>
<li><a href="test_cache.html">test_cache</a></li>
<li><a href="test_docgenerator.html">test_docgenerator</a></li>
<li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li>
<li><a href="test_html_writer.html">test_html_writer</a></li>
<li><a href="test_integration.html">test_integration</a></li>
<li><a href="test_llm_client.html">test_llm_client</a></li>
<li><a href="test_parser_matlab.html">test_parser_matlab</a></li>
<li><a href="test_parser_python.html">test_parser_python</a></li>
<li><a href="test_reviewer.html">test_reviewer</a></li>
<li><a href="test_scanner.html">test_scanner</a></li>
        </ul>
    </div>
    <div class="content">
        <h1>test_reviewer</h1>
        <p>This module defines functions to test the detection of assistant phrasing, contradictions, and hallucinations in Python modules. It uses a temporary directory to create mock module pages and then runs a `main` function from the `reviewer` module on these pages. The tests check for specific phrases like &quot;[ASSISTANT]&quot;, &quot;[CONTRADICTION]&quot;, and &quot;[HALLUCINATION]&quot; in the output, as well as verify that autofix removes certain phrasing from the HTML files.</p>
<h2>Functions</h2>
<h3 id="_make_module">_make_module(tmp_path: Path, summary: str, methods=None) -&gt; Path</h3>
<p>The function `_make_module` creates a mock module page for testing purposes. It takes three parameters: `tmp_path`, which is the temporary directory where the module page will be created; `summary`, which is a string summarizing the module; and `methods`, an optional list of methods to include in a class named &quot;Foo&quot;. The function returns the path to the generated module HTML file.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_make_module</span>(tmp_path: Path, summary: <span style="color: #008000">str</span>, methods<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> Path:
    data <span style="color: #666666">=</span> {
        <span style="color: #BA2121">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;mod&quot;</span>,
        <span style="color: #BA2121">&quot;summary&quot;</span>: summary,
        <span style="color: #BA2121">&quot;classes&quot;</span>: [],
        <span style="color: #BA2121">&quot;functions&quot;</span>: [],
    }
    <span style="color: #008000; font-weight: bold">if</span> methods <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>:
        data[<span style="color: #BA2121">&quot;classes&quot;</span>] <span style="color: #666666">=</span> [
            {<span style="color: #BA2121">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;Foo&quot;</span>, <span style="color: #BA2121">&quot;docstring&quot;</span>: <span style="color: #BA2121">&quot;&quot;</span>, <span style="color: #BA2121">&quot;summary&quot;</span>: <span style="color: #BA2121">&quot;&quot;</span>, <span style="color: #BA2121">&quot;methods&quot;</span>: methods}
        ]
    write_module_page(<span style="color: #008000">str</span>(tmp_path), data, [(<span style="color: #BA2121">&quot;index&quot;</span>, <span style="color: #BA2121">&quot;index.html&quot;</span>)])
    <span style="color: #008000; font-weight: bold">return</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;mod.html&quot;</span>
</code></pre>
<h3 id="test_assistant_phrasing_detected">test_assistant_phrasing_detected(tmp_path: Path, capsys) -&gt; None</h3>
<p>This function tests if assistant phrasing is detected and logged during the documentation generation process. It creates a temporary module with assistant phrasing, runs the main documentation generator function on it, captures the output, and asserts that both &quot;[ASSISTANT]&quot; and &quot;mod.html&quot; are present in the output.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_assistant_phrasing_detected</span>(tmp_path: Path, capsys) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    _make_module(tmp_path, <span style="color: #BA2121">&quot;You can use this class.&quot;</span>)
    main([<span style="color: #008000">str</span>(tmp_path)])
    out <span style="color: #666666">=</span> capsys<span style="color: #666666">.</span>readouterr()<span style="color: #666666">.</span>out
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;[ASSISTANT]&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> out
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;mod.html&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> out
</code></pre>
<h3 id="test_contradiction_detected">test_contradiction_detected(tmp_path: Path, capsys) -&gt; None</h3>
<p>This function `test_contradiction_detected` is designed to test the detection of contradictions within generated documentation. It creates a temporary module with specified methods, including their names, signatures, docstrings, and source code. The function then calls the main documentation generation process using the path to this temporary module as an argument. After execution, it captures the output from standard out (stdout) using `capsys`. Finally, it asserts that the string &quot;[CONTRADICTION]&quot; is present in the captured output, indicating that a contradiction was detected during the documentation generation process.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_contradiction_detected</span>(tmp_path: Path, capsys) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    methods <span style="color: #666666">=</span> [{<span style="color: #BA2121">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;bar&quot;</span>, <span style="color: #BA2121">&quot;signature&quot;</span>: <span style="color: #BA2121">&quot;def bar()&quot;</span>, <span style="color: #BA2121">&quot;docstring&quot;</span>: <span style="color: #BA2121">&quot;&quot;</span>, <span style="color: #BA2121">&quot;source&quot;</span>: <span style="color: #BA2121">&quot;&quot;</span>}]
    _make_module(tmp_path, <span style="color: #BA2121">&quot;No methods defined&quot;</span>, methods)
    main([<span style="color: #008000">str</span>(tmp_path)])
    out <span style="color: #666666">=</span> capsys<span style="color: #666666">.</span>readouterr()<span style="color: #666666">.</span>out
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;[CONTRADICTION]&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> out
</code></pre>
<h3 id="test_hallucination_detected">test_hallucination_detected(tmp_path: Path, capsys) -&gt; None</h3>
<p>The function `test_hallucination_detected` is a test function designed to verify the detection of hallucinations during documentation generation. It creates a temporary module with a specified description, runs the main documentation generation process on this module using the provided path, and then checks if the output contains the marker &quot;[HALLUCINATION]&quot;.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_hallucination_detected</span>(tmp_path: Path, capsys) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    _make_module(tmp_path, <span style="color: #BA2121">&quot;Implements tic-tac-toe features&quot;</span>)
    main([<span style="color: #008000">str</span>(tmp_path)])
    out <span style="color: #666666">=</span> capsys<span style="color: #666666">.</span>readouterr()<span style="color: #666666">.</span>out
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;[HALLUCINATION]&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> out
</code></pre>
<h3 id="test_autofix_removes_phrasing">test_autofix_removes_phrasing(tmp_path: Path) -&gt; None</h3>
<p>The function `test_autofix_removes_phrasing` is a test function designed to verify the functionality of an autofix feature within a documentation generation tool. It takes a temporary directory path as input and creates a module file with specific content. The function then runs the main documentation generation process with the `--autofix` option on this temporary directory. After processing, it reads the generated HTML file and asserts that certain phrases (in this case, &quot;You can&quot;) have been removed from the output, indicating that the autofix feature is working as expected by cleaning up phrasing in the generated documentation.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_autofix_removes_phrasing</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    html_path <span style="color: #666666">=</span> _make_module(tmp_path, <span style="color: #BA2121">&quot;You can call this.&quot;</span>)
    main([<span style="color: #008000">str</span>(tmp_path), <span style="color: #BA2121">&quot;--autofix&quot;</span>])
    html <span style="color: #666666">=</span> html_path<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">&quot;utf-8&quot;</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;You can&quot;</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> html
</code></pre>
    </div>
</body>
</html>
