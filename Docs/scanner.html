<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>scanner</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <button id="sidebar-toggle">Menu</button>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><a href="cache.html">cache</a></li><li><a href="chunk_utils.html">chunk_utils</a></li><li><a href="docgenerator.html">docgenerator</a></li><li><a href="explaincode.html">explaincode</a></li><li><a href="gui_wrapper.html">gui_wrapper</a></li><li><a href="html_writer.html">html_writer</a></li><li><a href="llm_client.html">llm_client</a></li><li><a href="manual_utils.html">manual_utils</a></li><li><a href="parser_cpp.html">parser_cpp</a></li><li><a href="parser_java.html">parser_java</a></li><li><a href="parser_matlab.html">parser_matlab</a></li><li><a href="parser_python.html">parser_python</a></li><li><a href="retrofit_sidebar.html">retrofit_sidebar</a></li><li><a href="reviewer.html">reviewer</a></li><li><a href="sanitize_docs.html">sanitize_docs</a></li><li><a href="scanner.html">scanner</a></li><li><a href="setup.html">setup</a></li><li><a href="summarize_utils.html">summarize_utils</a></li><li><details><summary>tests</summary><ul><li><a href="test_cache.html">test_cache</a></li><li><a href="test_chunk_utils.html">test_chunk_utils</a></li><li><a href="test_docgenerator.html">test_docgenerator</a></li><li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li><li><a href="test_explaincode.html">test_explaincode</a></li><li><a href="test_html_writer.html">test_html_writer</a></li><li><a href="test_integration.html">test_integration</a></li><li><a href="test_llm_client.html">test_llm_client</a></li><li><a href="test_manual_utils.html">test_manual_utils</a></li><li><a href="test_parser_cpp.html">test_parser_cpp</a></li><li><a href="test_parser_java.html">test_parser_java</a></li><li><a href="test_parser_matlab.html">test_parser_matlab</a></li><li><a href="test_parser_python.html">test_parser_python</a></li><li><a href="test_resume_progress.html">test_resume_progress</a></li><li><a href="test_retrofit_sidebar.html">test_retrofit_sidebar</a></li><li><a href="test_reviewer.html">test_reviewer</a></li><li><a href="test_sanitize_docs.html">test_sanitize_docs</a></li><li><a href="test_scanner.html">test_scanner</a></li></ul></details></li></ul>
    </div>
    <div class="content">
        <h1>scanner</h1>
        <p>Module implements source file discovery for DocGen-LM with recursive directory scanning and ignore rules. It identifies Python, MATLAB, C++, C, and Java files under a base path while excluding specified directories and files. The function supports optional progress bar display during scanning. Scanning respects ignore patterns relative to the base path and excludes .git directories. Results are returned as sorted list of absolute file paths.</p>
<h2>Functions</h2>
<h3 id="_is_subpath">_is_subpath(path: Path, parent: Path) -&gt; bool</h3>
<p>The function `_is_subpath` determines whether a given path is equal to or located within a specified parent directory. It takes two arguments: `path` and `parent`, both of type `Path`. The function attempts to compute the relative path of `path` with respect to `parent` using the `relative_to` method. If this operation succeeds without raising a `ValueError`, it indicates that `path` is indeed a subpath of `parent`, and the function returns `True`. Otherwise, if a `ValueError` is raised, the function returns `False`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_is_subpath</span>(path: Path, parent: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000">bool</span>:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Return True if *path* is equal to or inside *parent*.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">try</span>:
        path<span style="color: #666666">.</span>relative_to(parent)
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">True</span>
    <span style="color: #008000; font-weight: bold">except</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">False</span>
</code></pre>
<h3 id="scan_directory">scan_directory(base_path: str, ignore: List[str], show_progress: bool=False) -&gt; List[str]</h3>
<p>The function `scan_directory` recursively searches for source code files with extensions `.py`, `.m`, `.cpp`, `.h`, and `.java` under a specified base directory. It accepts a base path, a list of paths to ignore during the search, and an optional flag to display progress. The function returns a sorted list of absolute paths to the discovered files, excluding those that match ignored paths or are located within `.git` directories. The scanning process uses `os.walk` to traverse the directory tree, with optional progress indication via `tqdm`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">scan_directory</span>(base_path: <span style="color: #008000">str</span>, ignore: List[<span style="color: #008000">str</span>], show_progress: <span style="color: #008000">bool</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>) <span style="color: #666666">-&gt;</span> List[<span style="color: #008000">str</span>]:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Recursively discover ``.py``, ``.m``, ``.cpp``, ``.h``, and ``.java`` files under *base_path*.</span>

<span style="color: #BA2121; font-style: italic">    Parameters</span>
<span style="color: #BA2121; font-style: italic">    ----------</span>
<span style="color: #BA2121; font-style: italic">    base_path:</span>
<span style="color: #BA2121; font-style: italic">        Directory to search.</span>
<span style="color: #BA2121; font-style: italic">    ignore:</span>
<span style="color: #BA2121; font-style: italic">        List of paths (relative to ``base_path``) that should be skipped.</span>
<span style="color: #BA2121; font-style: italic">    show_progress:</span>
<span style="color: #BA2121; font-style: italic">        If True, display a progress bar while scanning.</span>
<span style="color: #BA2121; font-style: italic">    Returns</span>
<span style="color: #BA2121; font-style: italic">    -------</span>
<span style="color: #BA2121; font-style: italic">    list[str]</span>
<span style="color: #BA2121; font-style: italic">        Absolute paths to discovered source files.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    base <span style="color: #666666">=</span> Path(base_path)<span style="color: #666666">.</span>resolve()
    ignore_paths <span style="color: #666666">=</span> {(base <span style="color: #666666">/</span> p)<span style="color: #666666">.</span>resolve() <span style="color: #008000; font-weight: bold">for</span> p <span style="color: #AA22FF; font-weight: bold">in</span> ignore}
    results: List[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []

    walker <span style="color: #666666">=</span> os<span style="color: #666666">.</span>walk(base, topdown<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
    <span style="color: #008000; font-weight: bold">if</span> show_progress:
        walker <span style="color: #666666">=</span> tqdm(walker, desc<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Scanning sources&quot;</span>)

    <span style="color: #008000; font-weight: bold">for</span> root, dirs, files <span style="color: #AA22FF; font-weight: bold">in</span> walker:
        root_path <span style="color: #666666">=</span> Path(root)
        <span style="color: #3D7B7B; font-style: italic"># prune ignored directories and internal .git folders</span>
        dirs[:] <span style="color: #666666">=</span> [
            d
            <span style="color: #008000; font-weight: bold">for</span> d <span style="color: #AA22FF; font-weight: bold">in</span> dirs
            <span style="color: #008000; font-weight: bold">if</span> d <span style="color: #666666">!=</span> <span style="color: #BA2121">&quot;.git&quot;</span> <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">any</span>(_is_subpath(root_path <span style="color: #666666">/</span> d, ig) <span style="color: #008000; font-weight: bold">for</span> ig <span style="color: #AA22FF; font-weight: bold">in</span> ignore_paths)
        ]

        <span style="color: #008000; font-weight: bold">for</span> name <span style="color: #AA22FF; font-weight: bold">in</span> files:
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> name<span style="color: #666666">.</span>endswith((<span style="color: #BA2121">&quot;.py&quot;</span>, <span style="color: #BA2121">&quot;.m&quot;</span>, <span style="color: #BA2121">&quot;.cpp&quot;</span>, <span style="color: #BA2121">&quot;.h&quot;</span>, <span style="color: #BA2121">&quot;.java&quot;</span>)):
                <span style="color: #008000; font-weight: bold">continue</span>
            file_path <span style="color: #666666">=</span> root_path <span style="color: #666666">/</span> name
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">any</span>(_is_subpath(file_path, ig) <span style="color: #008000; font-weight: bold">for</span> ig <span style="color: #AA22FF; font-weight: bold">in</span> ignore_paths):
                <span style="color: #008000; font-weight: bold">continue</span>
            results<span style="color: #666666">.</span>append(<span style="color: #008000">str</span>(file_path))

    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">sorted</span>(results)
</code></pre>
    </div>
    <script src="static/toggle.js"></script>
</body>
</html>
