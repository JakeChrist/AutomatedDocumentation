<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>test_parser_python</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <button id="sidebar-toggle">Menu</button>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul>
        <li><a href="index.html"><strong>üè† Project Overview</strong></a></li>
<li><a href="cache.html">cache</a></li>
<li><a href="chunk_utils.html">chunk_utils</a></li>
<li><a href="docgenerator.html">docgenerator</a></li>
<li><a href="explaincode.html">explaincode</a></li>
<li><a href="gui_wrapper.html">gui_wrapper</a></li>
<li><a href="html_writer.html">html_writer</a></li>
<li><a href="llm_client.html">llm_client</a></li>
<li><a href="manual_utils.html">manual_utils</a></li>
<li><a href="parser_matlab.html">parser_matlab</a></li>
<li><a href="parser_python.html">parser_python</a></li>
<li><a href="reviewer.html">reviewer</a></li>
<li><a href="scanner.html">scanner</a></li>
<li><a href="setup.html">setup</a></li>
<li><a href="summarize_utils.html">summarize_utils</a></li>
<li><a href="test_cache.html">test_cache</a></li>
<li><a href="test_chunk_utils.html">test_chunk_utils</a></li>
<li><a href="test_docgenerator.html">test_docgenerator</a></li>
<li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li>
<li><a href="test_explaincode.html">test_explaincode</a></li>
<li><a href="test_html_writer.html">test_html_writer</a></li>
<li><a href="test_integration.html">test_integration</a></li>
<li><a href="test_llm_client.html">test_llm_client</a></li>
<li><a href="test_manual_utils.html">test_manual_utils</a></li>
<li><a href="test_parser_matlab.html">test_parser_matlab</a></li>
<li><a href="test_parser_python.html">test_parser_python</a></li>
<li><a href="test_reviewer.html">test_reviewer</a></li>
<li><a href="test_scanner.html">test_scanner</a></li>
        </ul>
    </div>
    <div class="content">
        <h1>test_parser_python</h1>
        <p>The module defines several test functions to verify the functionality of a `parse_python_file` function. Each test function creates a temporary Python file with different structures (simple modules, complex signatures, nested classes) and asserts that the `parse_python_file` function correctly parses these structures into a dictionary containing information about modules, classes, methods, and functions.</p>
<h2>Functions</h2>
<h3 id="test_parse_simple_module">test_parse_simple_module(tmp_path: Path) -&gt; None</h3>
<p>This function `test_parse_simple_module` tests the parsing of a Python module using the `parse_python_file` function. It creates a temporary file with a simple Python module containing a class and a function, then parses the file to extract information about the module, classes, and functions. The test checks that the parsed data matches the expected values for the module docstring, class name, class docstring, method signature, method docstring, and function details.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_parse_simple_module</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;Example module.&quot;&quot;&quot;</span>

<span style="color: #BA2121; font-style: italic">        def add(x: int, y: int) -&gt; int:</span>
<span style="color: #BA2121; font-style: italic">            &quot;&quot;&quot;Add two numbers.&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">            return x + y</span>

<span style="color: #BA2121; font-style: italic">        class Greeter:</span>
<span style="color: #BA2121; font-style: italic">            &quot;&quot;&quot;Says hi.&quot;&quot;&quot;</span>

<span style="color: #BA2121; font-style: italic">            def greet(self, name: str = &quot;World&quot;) -&gt; str:</span>
<span style="color: #BA2121; font-style: italic">                &quot;&quot;&quot;Return a greeting.&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">                return f&quot;Hello, {name}&quot;</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;sample.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    <span style="color: #008000; font-weight: bold">assert</span> result[<span style="color: #BA2121">&quot;module_docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Example module.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(result[<span style="color: #BA2121">&quot;classes&quot;</span>]) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000">cls</span> <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Greeter&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Says hi.&quot;</span>
    method <span style="color: #666666">=</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> method[<span style="color: #BA2121">&quot;signature&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;greet(self, name: str=&#39;World&#39;) -&gt; str&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> method[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Return a greeting.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;def greet&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> method[<span style="color: #BA2121">&quot;source&quot;</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Return a greeting.&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> method[<span style="color: #BA2121">&quot;source&quot;</span>]

    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(result[<span style="color: #BA2121">&quot;functions&quot;</span>]) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    func <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;add&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;signature&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;add(x: int, y: int) -&gt; int&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;returns&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;int&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Add two numbers.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;def add&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> func[<span style="color: #BA2121">&quot;source&quot;</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Add two numbers.&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> func[<span style="color: #BA2121">&quot;source&quot;</span>]
</code></pre>
<h3 id="test_parse_complex_signature">test_parse_complex_signature(tmp_path: Path) -&gt; None</h3>
<p>This function `test_parse_complex_signature` is designed to test the parsing of a Python file containing a complex function signature. It uses a temporary directory provided by `tmp_path` to create a sample Python file named `sample.py`. The function writes a specific Python code snippet into this file, which includes a docstring and a complex function definition.

The function then calls `parse_python_file` with the path of the created file as an argument. This function is expected to parse the Python source code and return a dictionary containing information about the parsed file, including its functions.

In the test case, it specifically checks the signature of the first function in the parsed result, which should match the string `&quot;complex(a/, b, *, c: int=1, **kw) -&gt; None&quot;`. It also verifies that the docstring of the function is correctly extracted and matches `&quot;Complex function.&quot;`, and that this docstring is present in the source code.

The assertions ensure that the parsing functionality works as expected for complex Python function signatures.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_parse_complex_signature</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;Docstring.&quot;&quot;&quot;</span>

<span style="color: #BA2121; font-style: italic">        def complex(a, /, b, *, c: int = 1, **kw) -&gt; None:</span>
<span style="color: #BA2121; font-style: italic">            &quot;&quot;&quot;Complex function.&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">            pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;sample.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    sig <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;signature&quot;</span>]
    func <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> sig <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;complex(a/, b, *, c: int=1, **kw) -&gt; None&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Complex function.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Complex function.&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> func[<span style="color: #BA2121">&quot;source&quot;</span>]
</code></pre>
<h3 id="test_parse_nested_structures">test_parse_nested_structures(tmp_path: Path) -&gt; None</h3>
<p>This function `test_parse_nested_structures` tests the parsing of nested structures in Python code. It creates a temporary file with a Python script containing nested functions and subclasses, then uses the `parse_python_file` function to parse this file. The test asserts that the parsed result correctly identifies the outer function, its inner function, and the classes and methods within them.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_parse_nested_structures</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        def outer(x):</span>
<span style="color: #BA2121; font-style: italic">            def inner(y):</span>
<span style="color: #BA2121; font-style: italic">                return y * 2</span>
<span style="color: #BA2121; font-style: italic">            return inner(x)</span>

<span style="color: #BA2121; font-style: italic">        class A:</span>
<span style="color: #BA2121; font-style: italic">            class B:</span>
<span style="color: #BA2121; font-style: italic">                def method(self):</span>
<span style="color: #BA2121; font-style: italic">                    pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;sample.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    outer <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> outer[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;outer&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(outer<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;subfunctions&quot;</span>, [])) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">assert</span> outer[<span style="color: #BA2121">&quot;subfunctions&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;inner&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;def inner&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> outer[<span style="color: #BA2121">&quot;subfunctions&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;source&quot;</span>]

    <span style="color: #008000">cls</span> <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;A&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(<span style="color: #008000">cls</span><span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;subclasses&quot;</span>, [])) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    sub <span style="color: #666666">=</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> sub[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;B&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(sub<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;methods&quot;</span>, [])) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">assert</span> sub[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;method&quot;</span>
</code></pre>
<h3 id="test_deeply_nested_classes">test_deeply_nested_classes(tmp_path: Path) -&gt; None</h3>
<p>The function `test_deeply_nested_classes` tests the parsing of Python files containing deeply nested classes. It creates a temporary file with nested class definitions and uses the `parse_python_file` function to parse this file. The test then checks if the nested classes are correctly identified and their methods are properly listed.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_deeply_nested_classes</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        class A:</span>
<span style="color: #BA2121; font-style: italic">            class B:</span>
<span style="color: #BA2121; font-style: italic">                class C:</span>
<span style="color: #BA2121; font-style: italic">                    def inner(self):</span>
<span style="color: #BA2121; font-style: italic">                        pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;deep.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    a <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    b <span style="color: #666666">=</span> a[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    c <span style="color: #666666">=</span> b[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> c[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;C&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> c[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;inner&quot;</span>
</code></pre>
<h3 id="test_class_inside_method">test_class_inside_method(tmp_path: Path) -&gt; None</h3>
<p>This function, `test_class_inside_method`, tests the parsing of a Python file containing a class inside another method. It uses a temporary path to create a source file named &quot;inner.py&quot; with the specified content. The function then parses this file using the `parse_python_file` function and asserts that:
1. There is one top-level class (`A`) in the parsed result.
2. Class `A` has one subclass (`B`).
3. Subclass `B` has one method named `m`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_class_inside_method</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        class A:</span>
<span style="color: #BA2121; font-style: italic">            def outer(self):</span>
<span style="color: #BA2121; font-style: italic">                class B:</span>
<span style="color: #BA2121; font-style: italic">                    def m(self):</span>
<span style="color: #BA2121; font-style: italic">                        pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;inner.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    a <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(a[<span style="color: #BA2121">&quot;subclasses&quot;</span>]) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    b <span style="color: #666666">=</span> a[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> b[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;B&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> b[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;m&quot;</span>
</code></pre>
    </div>
    <script src="static/toggle.js"></script>
</body>
</html>
