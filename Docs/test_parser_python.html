<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>test_parser_python</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <button id="sidebar-toggle">Menu</button>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><a href="cache.html">cache</a></li><li><a href="chunk_utils.html">chunk_utils</a></li><li><a href="docgenerator.html">docgenerator</a></li><li><a href="explaincode.html">explaincode</a></li><li><a href="gui_wrapper.html">gui_wrapper</a></li><li><a href="html_writer.html">html_writer</a></li><li><a href="llm_client.html">llm_client</a></li><li><a href="manual_utils.html">manual_utils</a></li><li><a href="parser_cpp.html">parser_cpp</a></li><li><a href="parser_java.html">parser_java</a></li><li><a href="parser_matlab.html">parser_matlab</a></li><li><a href="parser_python.html">parser_python</a></li><li><a href="retrofit_sidebar.html">retrofit_sidebar</a></li><li><a href="reviewer.html">reviewer</a></li><li><a href="sanitize_docs.html">sanitize_docs</a></li><li><a href="scanner.html">scanner</a></li><li><a href="setup.html">setup</a></li><li><a href="summarize_utils.html">summarize_utils</a></li><li><details><summary>tests</summary><ul><li><a href="test_cache.html">test_cache</a></li><li><a href="test_chunk_utils.html">test_chunk_utils</a></li><li><a href="test_docgenerator.html">test_docgenerator</a></li><li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li><li><a href="test_explaincode.html">test_explaincode</a></li><li><a href="test_html_writer.html">test_html_writer</a></li><li><a href="test_integration.html">test_integration</a></li><li><a href="test_llm_client.html">test_llm_client</a></li><li><a href="test_manual_utils.html">test_manual_utils</a></li><li><a href="test_parser_cpp.html">test_parser_cpp</a></li><li><a href="test_parser_java.html">test_parser_java</a></li><li><a href="test_parser_matlab.html">test_parser_matlab</a></li><li><a href="test_parser_python.html">test_parser_python</a></li><li><a href="test_resume_progress.html">test_resume_progress</a></li><li><a href="test_retrofit_sidebar.html">test_retrofit_sidebar</a></li><li><a href="test_reviewer.html">test_reviewer</a></li><li><a href="test_sanitize_docs.html">test_sanitize_docs</a></li><li><a href="test_scanner.html">test_scanner</a></li></ul></details></li></ul>
    </div>
    <div class="content">
        <h1>test_parser_python</h1>
        <p>Module defines test cases for parsing Python files using a `parse_python_file` function. Tests cover simple modules with functions and classes, including docstrings and signatures. Additional tests handle complex function signatures with positional-only, keyword-only, and variable arguments. Nested structures such as inner functions, nested classes, and classes defined inside methods are also tested. Each test validates specific aspects of the parsed output like names, signatures, docstrings, and source code inclusion.</p>
<h2>Functions</h2>
<h3 id="test_parse_simple_module">test_parse_simple_module(tmp_path: Path) -&gt; None</h3>
<p>The function `test_parse_simple_module` tests the parsing of a simple Python module using the `parse_python_file` function. It creates a temporary Python file with a module docstring, a function `add`, and a class `Greeter` with a method `greet`. The test verifies that the parsed result correctly extracts:


The test ensures that all extracted elements match their expected values, confirming correct parsing of Python code structures.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_parse_simple_module</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;Example module.&quot;&quot;&quot;</span>

<span style="color: #BA2121; font-style: italic">        def add(x: int, y: int) -&gt; int:</span>
<span style="color: #BA2121; font-style: italic">            &quot;&quot;&quot;Add two numbers.&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">            return x + y</span>

<span style="color: #BA2121; font-style: italic">        class Greeter:</span>
<span style="color: #BA2121; font-style: italic">            &quot;&quot;&quot;Says hi.&quot;&quot;&quot;</span>

<span style="color: #BA2121; font-style: italic">            def greet(self, name: str = &quot;World&quot;) -&gt; str:</span>
<span style="color: #BA2121; font-style: italic">                &quot;&quot;&quot;Return a greeting.&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">                return f&quot;Hello, {name}&quot;</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;sample.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    <span style="color: #008000; font-weight: bold">assert</span> result[<span style="color: #BA2121">&quot;module_docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Example module.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(result[<span style="color: #BA2121">&quot;classes&quot;</span>]) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000">cls</span> <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Greeter&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Says hi.&quot;</span>
    method <span style="color: #666666">=</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> method[<span style="color: #BA2121">&quot;signature&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;greet(self, name: str=&#39;World&#39;) -&gt; str&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> method[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Return a greeting.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;def greet&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> method[<span style="color: #BA2121">&quot;source&quot;</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Return a greeting.&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> method[<span style="color: #BA2121">&quot;source&quot;</span>]

    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(result[<span style="color: #BA2121">&quot;functions&quot;</span>]) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    func <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;add&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;signature&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;add(x: int, y: int) -&gt; int&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;returns&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;int&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Add two numbers.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;def add&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> func[<span style="color: #BA2121">&quot;source&quot;</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Add two numbers.&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> func[<span style="color: #BA2121">&quot;source&quot;</span>]
</code></pre>
<h3 id="test_parse_complex_signature">test_parse_complex_signature(tmp_path: Path) -&gt; None</h3>
<p>The function `test_parse_complex_signature` tests the parsing of a Python function signature that includes complex parameter types such as positional-only, keyword-only, default values, and arbitrary keyword arguments. It creates a temporary Python file with a defined function, parses the file using `parse_python_file`, and verifies that the parsed signature, docstring, and source code match expected values. The test ensures correct handling of function signatures with mixed parameter types and documentation extraction.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_parse_complex_signature</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;Docstring.&quot;&quot;&quot;</span>

<span style="color: #BA2121; font-style: italic">        def complex(a, /, b, *, c: int = 1, **kw) -&gt; None:</span>
<span style="color: #BA2121; font-style: italic">            &quot;&quot;&quot;Complex function.&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">            pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;sample.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    sig <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;signature&quot;</span>]
    func <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> sig <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;complex(a/, b, *, c: int=1, **kw) -&gt; None&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> func[<span style="color: #BA2121">&quot;docstring&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;Complex function.&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Complex function.&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> func[<span style="color: #BA2121">&quot;source&quot;</span>]
</code></pre>
<h3 id="test_parse_nested_structures">test_parse_nested_structures(tmp_path: Path) -&gt; None</h3>
<p>The function `test_parse_nested_structures` tests the parsing of nested Python structures, including nested functions and classes. It creates a temporary Python file with an outer function containing an inner function, and a class `A` containing a nested class `B` with a method. The test verifies that the parser correctly identifies and extracts these nested elements, checking the names and source code of the inner function, as well as the structure of the nested class and its method. The test ensures proper handling of function and class hierarchies during parsing.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_parse_nested_structures</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        def outer(x):</span>
<span style="color: #BA2121; font-style: italic">            def inner(y):</span>
<span style="color: #BA2121; font-style: italic">                return y * 2</span>
<span style="color: #BA2121; font-style: italic">            return inner(x)</span>

<span style="color: #BA2121; font-style: italic">        class A:</span>
<span style="color: #BA2121; font-style: italic">            class B:</span>
<span style="color: #BA2121; font-style: italic">                def method(self):</span>
<span style="color: #BA2121; font-style: italic">                    pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;sample.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    outer <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;functions&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> outer[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;outer&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(outer<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;subfunctions&quot;</span>, [])) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">assert</span> outer[<span style="color: #BA2121">&quot;subfunctions&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;inner&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;def inner&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> outer[<span style="color: #BA2121">&quot;subfunctions&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;source&quot;</span>]

    <span style="color: #008000">cls</span> <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;A&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(<span style="color: #008000">cls</span><span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;subclasses&quot;</span>, [])) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    sub <span style="color: #666666">=</span> <span style="color: #008000">cls</span>[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> sub[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;B&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(sub<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;methods&quot;</span>, [])) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">assert</span> sub[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;method&quot;</span>
</code></pre>
<h3 id="test_deeply_nested_classes">test_deeply_nested_classes(tmp_path: Path) -&gt; None</h3>
<p>The function `test_deeply_nested_classes` tests the parsing of deeply nested class structures in a Python source file. It creates a temporary Python file containing a class `A` with nested classes `B` and `C`, where class `C` contains a method `inner`. The test parses this file using `parse_python_file`, then verifies that the parsed structure correctly represents the nested classes and their methods by asserting the names of the innermost class `C` and its method `inner`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_deeply_nested_classes</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        class A:</span>
<span style="color: #BA2121; font-style: italic">            class B:</span>
<span style="color: #BA2121; font-style: italic">                class C:</span>
<span style="color: #BA2121; font-style: italic">                    def inner(self):</span>
<span style="color: #BA2121; font-style: italic">                        pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;deep.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    a <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    b <span style="color: #666666">=</span> a[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    c <span style="color: #666666">=</span> b[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> c[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;C&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> c[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;inner&quot;</span>
</code></pre>
<h3 id="test_class_inside_method">test_class_inside_method(tmp_path: Path) -&gt; None</h3>
<p>The function `test_class_inside_method` tests the parsing of a Python file that contains a class defined inside a method of another class. It creates a temporary Python file with nested class definitions, parses the file using `parse_python_file`, and verifies that the parsed result correctly identifies the outer class `A`, its nested subclass `B`, and the method `m` within `B`. The test ensures that the parser accurately captures the hierarchical structure of nested classes and their methods.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_class_inside_method</span>(tmp_path: Path) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src <span style="color: #666666">=</span> textwrap<span style="color: #666666">.</span>dedent(
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">        class A:</span>
<span style="color: #BA2121; font-style: italic">            def outer(self):</span>
<span style="color: #BA2121; font-style: italic">                class B:</span>
<span style="color: #BA2121; font-style: italic">                    def m(self):</span>
<span style="color: #BA2121; font-style: italic">                        pass</span>
<span style="color: #BA2121; font-style: italic">        &#39;&#39;&#39;</span>
    )
    file <span style="color: #666666">=</span> tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;inner.py&quot;</span>
    file<span style="color: #666666">.</span>write_text(src)

    result <span style="color: #666666">=</span> parse_python_file(<span style="color: #008000">str</span>(file))

    a <span style="color: #666666">=</span> result[<span style="color: #BA2121">&quot;classes&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(a[<span style="color: #BA2121">&quot;subclasses&quot;</span>]) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    b <span style="color: #666666">=</span> a[<span style="color: #BA2121">&quot;subclasses&quot;</span>][<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> b[<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;B&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> b[<span style="color: #BA2121">&quot;methods&quot;</span>][<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;name&quot;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;m&quot;</span>
</code></pre>
    </div>
    <script src="static/toggle.js"></script>
</body>
</html>
