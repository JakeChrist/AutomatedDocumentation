<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>cache</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul>
        <li><a href="index.html"><strong>üè† Project Overview</strong></a></li>
<li><a href="cache.html">cache</a></li>
<li><a href="docgenerator.html">docgenerator</a></li>
<li><a href="html_writer.html">html_writer</a></li>
<li><a href="llm_client.html">llm_client</a></li>
<li><a href="parser_matlab.html">parser_matlab</a></li>
<li><a href="parser_python.html">parser_python</a></li>
<li><a href="reviewer.html">reviewer</a></li>
<li><a href="scanner.html">scanner</a></li>
<li><a href="test_cache.html">test_cache</a></li>
<li><a href="test_docgenerator.html">test_docgenerator</a></li>
<li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li>
<li><a href="test_html_writer.html">test_html_writer</a></li>
<li><a href="test_integration.html">test_integration</a></li>
<li><a href="test_llm_client.html">test_llm_client</a></li>
<li><a href="test_parser_matlab.html">test_parser_matlab</a></li>
<li><a href="test_parser_python.html">test_parser_python</a></li>
<li><a href="test_reviewer.html">test_reviewer</a></li>
<li><a href="test_scanner.html">test_scanner</a></li>
        </ul>
    </div>
    <div class="content">
        <h1>cache</h1>
        <p>A simple on-disk cache for LLM responses. Implements methods to initialize the cache from a file, generate deterministic keys based on file paths and content, retrieve cached values by key, store new key-value pairs and persist them to disk, and save the current state of the cache to a JSON file.</p>
<h2 id="ResponseCache">Class: ResponseCache</h2>
<p>The `ResponseCache` class provides a mechanism for caching and persisting mappings from stable keys to language model responses. It initializes by loading existing data from a specified file path, or creating an empty dictionary if the file does not exist. The class includes methods for generating deterministic keys based on file paths and content, retrieving cached values, storing new key-value pairs, and saving the current state of the cache to disk in JSON format.</p>
<h3 id="__init__">Method: __init__(self, path: str) -&gt; None</h3>
<p>Initializes an object with a file path. If the file exists, it reads and parses JSON content into a dictionary; otherwise, it initializes an empty dictionary.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, path: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>file <span style="color: #666666">=</span> Path(path)
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>file<span style="color: #666666">.</span>exists():
            <span style="color: #008000; font-weight: bold">try</span>:
                <span style="color: #008000">self</span><span style="color: #666666">.</span>_data: Dict[<span style="color: #008000">str</span>, <span style="color: #008000">str</span>] <span style="color: #666666">=</span> json<span style="color: #666666">.</span>loads(<span style="color: #008000">self</span><span style="color: #666666">.</span>file<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">&quot;utf-8&quot;</span>))
            <span style="color: #008000; font-weight: bold">except</span> json<span style="color: #666666">.</span>JSONDecodeError:
                <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> {}
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> {}
</code></pre>
<h3 id="make_key">Method: make_key(file_path: str, content: str) -&gt; str</h3>
<p>The function `make_key` takes two parameters, `file_path` as a string representing the path to a file, and `content` as a string representing the content of that file. It returns a deterministic key by hashing the content using SHA-256 and appending the file path to the hexadecimal digest of the hash.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">make_key</span>(file_path: <span style="color: #008000">str</span>, content: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Return a deterministic key for *file_path* and *content*.&quot;&quot;&quot;</span>
        digest <span style="color: #666666">=</span> hashlib<span style="color: #666666">.</span>sha256(content<span style="color: #666666">.</span>encode(<span style="color: #BA2121">&quot;utf-8&quot;</span>))<span style="color: #666666">.</span>hexdigest()
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">f&quot;</span><span style="color: #A45A77; font-weight: bold">{</span>file_path<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">:</span><span style="color: #A45A77; font-weight: bold">{</span>digest<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>
</code></pre>
<h3 id="get">Method: get(self, key: str) -&gt; Optional[str]</h3>
<p>Returns the cached value associated with a given key if it exists in the cache. If the key is not found, returns `None`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get</span>(<span style="color: #008000">self</span>, key: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> Optional[<span style="color: #008000">str</span>]:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Return the cached value for ``key`` if present.&quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_data<span style="color: #666666">.</span>get(key)
</code></pre>
<h3 id="set">Method: set(self, key: str, value: str) -&gt; None</h3>
<p>Stores a value under a given key in an internal data structure and persists the changes to disk.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set</span>(<span style="color: #008000">self</span>, key: <span style="color: #008000">str</span>, value: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Store ``value`` under ``key`` and persist to disk.&quot;&quot;&quot;</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data[key] <span style="color: #666666">=</span> value
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_save()
</code></pre>
<h3 id="_save">Method: _save(self) -&gt; None</h3>
<p>The function `_save` writes the contents of `self._data` to a file using the `write_text` method. The data is serialized as JSON with an indentation of 2 spaces and keys sorted alphabetically. The file&#x27;s encoding is set to &quot;utf-8&quot;.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_save</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>file<span style="color: #666666">.</span>write_text(json<span style="color: #666666">.</span>dumps(<span style="color: #008000">self</span><span style="color: #666666">.</span>_data, indent<span style="color: #666666">=2</span>, sort_keys<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>), encoding<span style="color: #666666">=</span><span style="color: #BA2121">&quot;utf-8&quot;</span>)
</code></pre>
    </div>
</body>
</html>
