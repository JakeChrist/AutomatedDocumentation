<!-- Generated by DocGen-LM -->
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
    
<title>cache</title>
<link href="static/style.css" rel="stylesheet"/>
</head>
<body class="doc-body">
<button aria-label="Toggle navigation menu" class="sidebar-toggle" id="sidebar-toggle">Menu</button>
<div aria-label="Documentation navigation" class="sidebar" role="navigation">
<h2>Navigation</h2>
<ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><a href="cache.html">cache</a></li><li><a href="chunk_utils.html">chunk_utils</a></li><li><a href="docgenerator.html">docgenerator</a></li><li><a href="explaincode.html">explaincode</a></li><li><a href="gui_wrapper.html">gui_wrapper</a></li><li><a href="html_writer.html">html_writer</a></li><li><a href="llm_client.html">llm_client</a></li><li><a href="manual_utils.html">manual_utils</a></li><li><a href="parser_cpp.html">parser_cpp</a></li><li><a href="parser_java.html">parser_java</a></li><li><a href="parser_matlab.html">parser_matlab</a></li><li><a href="parser_python.html">parser_python</a></li><li><a href="retrofit_sidebar.html">retrofit_sidebar</a></li><li><a href="reviewer.html">reviewer</a></li><li><a href="sanitize_docs.html">sanitize_docs</a></li><li><a href="scanner.html">scanner</a></li><li><a href="setup.html">setup</a></li><li><a href="summarize_utils.html">summarize_utils</a></li><li><details><summary>tests</summary><ul><li><a href="test_cache.html">test_cache</a></li><li><a href="test_chunk_utils.html">test_chunk_utils</a></li><li><a href="test_docgenerator.html">test_docgenerator</a></li><li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li><li><a href="test_explaincode.html">test_explaincode</a></li><li><a href="test_html_writer.html">test_html_writer</a></li><li><a href="test_integration.html">test_integration</a></li><li><a href="test_llm_client.html">test_llm_client</a></li><li><a href="test_manual_utils.html">test_manual_utils</a></li><li><a href="test_parser_cpp.html">test_parser_cpp</a></li><li><a href="test_parser_java.html">test_parser_java</a></li><li><a href="test_parser_matlab.html">test_parser_matlab</a></li><li><a href="test_parser_python.html">test_parser_python</a></li><li><a href="test_resume_progress.html">test_resume_progress</a></li><li><a href="test_retrofit_sidebar.html">test_retrofit_sidebar</a></li><li><a href="test_reviewer.html">test_reviewer</a></li><li><a href="test_sanitize_docs.html">test_sanitize_docs</a></li><li><a href="test_scanner.html">test_scanner</a></li></ul></details></li></ul>
</div>
<main class="content" role="main">
        <div class="content-inner">
<h1>cache</h1>
<p>The module implements a disk-based cache for storing and retrieving LLM responses. It provides functionality to generate deterministic keys based on file paths and content, retrieve cached values, store new values, and manage progress tracking for processed modules. The cache persists data to a JSON file and supports operations to clear progress information.</p>
<h2 id="ResponseCache">Class: ResponseCache</h2>
<p>The `ResponseCache` class provides a persistent cache for storing and retrieving LLM responses using stable keys derived from file paths and content hashes. It supports operations to get and set cached values, manage progress tracking for processed modules, and persist all data to a JSON file. The class ensures data integrity by loading existing cache files on initialization and saving changes automatically upon modification.</p>
<h3 id="__init__">Method: __init__(self, path: str) -&gt; None</h3>
<p>Initializes the `ResponseCache` instance by loading cached data from a specified file path. If the file exists and contains valid JSON, it loads the data into `_data`. If the file does not exist or contains invalid JSON, it initializes `_data` as an empty dictionary. Ensures that a `"__progress__"` key exists in `_data`, initializing it as an empty dictionary if it is missing.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, path: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>file <span style="color: #666666">=</span> Path(path)
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>file<span style="color: #666666">.</span>exists():
            <span style="color: #008000; font-weight: bold">try</span>:
                <span style="color: #008000">self</span><span style="color: #666666">.</span>_data: Dict[<span style="color: #008000">str</span>, Any] <span style="color: #666666">=</span> json<span style="color: #666666">.</span>loads(
                    <span style="color: #008000">self</span><span style="color: #666666">.</span>file<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">"utf-8"</span>)
                )
            <span style="color: #008000; font-weight: bold">except</span> json<span style="color: #666666">.</span>JSONDecodeError:
                <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> {}
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> {}
        <span style="color: #3D7B7B; font-style: italic"># ensure progress map exists</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data<span style="color: #666666">.</span>setdefault(<span style="color: #BA2121">"__progress__"</span>, {})
</code></pre>
<h3 id="make_key">Method: make_key(file_path: str, content: str) -&gt; str</h3>
<p>The function `make_key` generates a deterministic key based on a file path and its content. It takes two parameters: `file_path` (a string representing the path to a file) and `content` (a string representing the file's content). The function computes a SHA-256 hash of the encoded content and combines it with the file path to produce a unique key in the format `file_path:digest`, where `digest` is the hexadecimal representation of the hash. This key can be used to uniquely identify a specific file and its content for caching or indexing purposes.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">make_key</span>(file_path: <span style="color: #008000">str</span>, content: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">"""Return a deterministic key for *file_path* and *content*."""</span>
        digest <span style="color: #666666">=</span> hashlib<span style="color: #666666">.</span>sha256(content<span style="color: #666666">.</span>encode(<span style="color: #BA2121">"utf-8"</span>))<span style="color: #666666">.</span>hexdigest()
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">f"</span><span style="color: #A45A77; font-weight: bold">{</span>file_path<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">:</span><span style="color: #A45A77; font-weight: bold">{</span>digest<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">"</span>
</code></pre>
<h3 id="get">Method: get(self, key: str) -&gt; Optional[str]</h3>
<p>The `get` method retrieves a cached value associated with the specified key from the internal data storage of the `ResponseCache` class. If the key exists in the cache, the corresponding value is returned; otherwise, None is returned. The method takes a string key as input and returns an optional string value.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get</span>(<span style="color: #008000">self</span>, key: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> Optional[<span style="color: #008000">str</span>]:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">"""Return the cached value for ``key`` if present."""</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_data<span style="color: #666666">.</span>get(key)
</code></pre>
<h3 id="set">Method: set(self, key: str, value: str) -&gt; None</h3>
<p>The `set` method stores a string value under a specified key in the response cache and persists the updated cache to disk. It updates the internal data dictionary with the key-value pair and then invokes the `_save` method to write the changes to storage.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set</span>(<span style="color: #008000">self</span>, key: <span style="color: #008000">str</span>, value: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">"""Store ``value`` under ``key`` and persist to disk."""</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data[key] <span style="color: #666666">=</span> value
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_save()
</code></pre>
<h3 id="get_progress">Method: get_progress(self) -&gt; Dict[str, Any]</h3>
<p>The function `get_progress` retrieves and returns a shallow copy of the progress tracking data stored in the `_data` attribute of the `ResponseCache` class. The progress data maps processed module paths to their corresponding information. By returning a copy, the function prevents external modifications to the internal progress mapping.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_progress</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> Dict[<span style="color: #008000">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">"""Return the mapping of processed module paths to their data."""</span>
        progress <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_data<span style="color: #666666">.</span>get(<span style="color: #BA2121">"__progress__"</span>, {})
        <span style="color: #3D7B7B; font-style: italic"># return a shallow copy to prevent accidental mutation</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">dict</span>(progress)
</code></pre>
<h3 id="set_progress_entry">Method: set_progress_entry(self, path: str, module_data: Dict[str, Any]) -&gt; None</h3>
<p>Records the provided `module_data` associated with the given `path` in the progress tracking structure. Updates the internal progress map and persists the changes by saving the data.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_progress_entry</span>(<span style="color: #008000">self</span>, path: <span style="color: #008000">str</span>, module_data: Dict[<span style="color: #008000">str</span>, Any]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">"""Record ``module_data`` for ``path`` in the progress map."""</span>
        progress <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_data<span style="color: #666666">.</span>setdefault(<span style="color: #BA2121">"__progress__"</span>, {})
        progress[path] <span style="color: #666666">=</span> module_data
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_save()
</code></pre>
<h3 id="clear_progress">Method: clear_progress(self) -&gt; None</h3>
<p>The `clear_progress` method removes all saved progress information by resetting the `"__progress__"` key in the internal data dictionary to an empty dictionary and then saving the updated state.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">clear_progress</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">"""Remove all saved progress information."""</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data[<span style="color: #BA2121">"__progress__"</span>] <span style="color: #666666">=</span> {}
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_save()
</code></pre>
<h3 id="_save">Method: _save(self) -&gt; None</h3>
<p>The function `_save` serializes the instance's data to a JSON format and writes it to a file. It uses `json.dumps` with `indent=2` and `sort_keys=True` for formatted output, then writes the resulting string to `self.file` using UTF-8 encoding. This method updates the cached data stored in the file associated with the instance.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_save</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>file<span style="color: #666666">.</span>write_text(json<span style="color: #666666">.</span>dumps(<span style="color: #008000">self</span><span style="color: #666666">.</span>_data, indent<span style="color: #666666">=2</span>, sort_keys<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>), encoding<span style="color: #666666">=</span><span style="color: #BA2121">"utf-8"</span>)
</code></pre>
</div>
    </main>
<script src="static/toggle.js"></script>
</body>
</html>
