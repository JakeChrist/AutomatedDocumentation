<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>test_chunk_utils</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <button id="sidebar-toggle">Menu</button>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul>
        <li><a href="index.html"><strong>üè† Project Overview</strong></a></li>
<li><a href="cache.html">cache</a></li>
<li><a href="chunk_utils.html">chunk_utils</a></li>
<li><a href="docgenerator.html">docgenerator</a></li>
<li><a href="explaincode.html">explaincode</a></li>
<li><a href="gui_wrapper.html">gui_wrapper</a></li>
<li><a href="html_writer.html">html_writer</a></li>
<li><a href="llm_client.html">llm_client</a></li>
<li><a href="manual_utils.html">manual_utils</a></li>
<li><a href="parser_cpp.html">parser_cpp</a></li>
<li><a href="parser_java.html">parser_java</a></li>
<li><a href="parser_matlab.html">parser_matlab</a></li>
<li><a href="parser_python.html">parser_python</a></li>
<li><a href="reviewer.html">reviewer</a></li>
<li><a href="scanner.html">scanner</a></li>
<li><a href="setup.html">setup</a></li>
<li><a href="summarize_utils.html">summarize_utils</a></li>
<li><a href="test_cache.html">test_cache</a></li>
<li><a href="test_chunk_utils.html">test_chunk_utils</a></li>
<li><a href="test_docgenerator.html">test_docgenerator</a></li>
<li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li>
<li><a href="test_explaincode.html">test_explaincode</a></li>
<li><a href="test_html_writer.html">test_html_writer</a></li>
<li><a href="test_integration.html">test_integration</a></li>
<li><a href="test_llm_client.html">test_llm_client</a></li>
<li><a href="test_manual_utils.html">test_manual_utils</a></li>
<li><a href="test_parser_cpp.html">test_parser_cpp</a></li>
<li><a href="test_parser_java.html">test_parser_java</a></li>
<li><a href="test_parser_matlab.html">test_parser_matlab</a></li>
<li><a href="test_parser_python.html">test_parser_python</a></li>
<li><a href="test_reviewer.html">test_reviewer</a></li>
<li><a href="test_scanner.html">test_scanner</a></li>
        </ul>
    </div>
    <div class="content">
        <h1>test_chunk_utils</h1>
        <p>The module defines several test functions to verify the functionality of `get_tokenizer` and `chunk_text`. It includes tests for:

1. Ensuring that `get_tokenizer` returns a tokenizer object.
2. Verifying that encoding and decoding text using the tokenizer preserves the original string.
3. Confirming that `chunk_text` can split a long text into chunks without reconstructing the content.
4. Checking that `chunk_text` splits markdown headings correctly when chunk size is limited.
5. Ensuring that `chunk_text` handles code blocks within the text appropriately, maintaining their integrity across chunks.</p>
<h2>Functions</h2>
<h3 id="test_get_tokenizer_roundtrip">test_get_tokenizer_roundtrip() -&gt; None</h3>
<p>This function tests the round-trip encoding and decoding functionality of a tokenizer. It retrieves a tokenizer instance, encodes a text string into tokens, asserts that the result is a list, decodes the tokens back to text, and verifies that the decoded text matches the original input after stripping any leading or trailing whitespace.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_get_tokenizer_roundtrip</span>() <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    tokenizer <span style="color: #666666">=</span> get_tokenizer()
    text <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;hello world&quot;</span>
    tokens <span style="color: #666666">=</span> tokenizer<span style="color: #666666">.</span>encode(text)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">isinstance</span>(tokens, <span style="color: #008000">list</span>)
    decoded <span style="color: #666666">=</span> tokenizer<span style="color: #666666">.</span>decode(tokens)
    <span style="color: #008000; font-weight: bold">assert</span> decoded<span style="color: #666666">.</span>strip() <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;hello world&quot;</span>
</code></pre>
<h3 id="test_chunk_text_reconstructs_content">test_chunk_text_reconstructs_content() -&gt; None</h3>
<p>This function tests the `chunk_text` function to ensure it correctly reconstructs the original text after chunking. It uses a tokenizer obtained from `get_tokenizer()`, splits a long string of repeated words into chunks with a maximum length of 10, and then joins these chunks back together. The test asserts that the reconstructed text matches the original text (ignoring leading/trailing whitespace) and that the number of chunks is greater than one, indicating successful chunking.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_chunk_text_reconstructs_content</span>() <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    tokenizer <span style="color: #666666">=</span> get_tokenizer()
    text <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;word &quot;</span> <span style="color: #666666">*</span> <span style="color: #666666">50</span>
    chunks <span style="color: #666666">=</span> chunk_text(text, tokenizer, <span style="color: #666666">10</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">.</span>join(chunks) <span style="color: #666666">==</span> text<span style="color: #666666">.</span>strip()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(chunks) <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>
</code></pre>
<h3 id="test_chunk_text_splits_markdown_headings">test_chunk_text_splits_markdown_headings() -&gt; None</h3>
<p>The function `test_chunk_text_splits_markdown_headings` tests the functionality of splitting text into chunks based on Markdown headings. It uses a tokenizer to process the input text, which contains two Markdown headings (`# H1` and `# H2`). The function then asserts that the text is split into exactly two chunks and that each chunk starts with the respective heading.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_chunk_text_splits_markdown_headings</span>() <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    tokenizer <span style="color: #666666">=</span> get_tokenizer()
    text <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;# H1</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">para1</span><span style="color: #AA5D1F; font-weight: bold">\n\n</span><span style="color: #BA2121"># H2</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">para2&quot;</span>
    chunks <span style="color: #666666">=</span> chunk_text(text, tokenizer, <span style="color: #666666">4</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(chunks) <span style="color: #666666">==</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">assert</span> chunks[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&quot;# H1&quot;</span>)
    <span style="color: #008000; font-weight: bold">assert</span> chunks[<span style="color: #666666">1</span>]<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&quot;# H2&quot;</span>)
</code></pre>
<h3 id="test_chunk_text_preserves_code_blocks">test_chunk_text_preserves_code_blocks() -&gt; None</h3>
<p>This function tests the `chunk_text` method to ensure it preserves code blocks when splitting text into chunks. It uses a tokenizer and specifies a maximum chunk size of 4. The test checks that at least one chunk contains the original code block and that each chunk has either zero or two backticks (indicating the start or end of a code block).</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_chunk_text_preserves_code_blocks</span>() <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    tokenizer <span style="color: #666666">=</span> get_tokenizer()
    text <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Intro</span><span style="color: #AA5D1F; font-weight: bold">\n\n</span><span style="color: #BA2121">```python</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">print(&#39;hi&#39;)</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">```</span><span style="color: #AA5D1F; font-weight: bold">\n\n</span><span style="color: #BA2121">Conclusion&quot;</span>
    chunks <span style="color: #666666">=</span> chunk_text(text, tokenizer, <span style="color: #666666">4</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">any</span>(<span style="color: #BA2121">&quot;```python</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">print(&#39;hi&#39;)</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">```&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> chunk <span style="color: #008000; font-weight: bold">for</span> chunk <span style="color: #AA22FF; font-weight: bold">in</span> chunks)
    <span style="color: #008000; font-weight: bold">for</span> chunk <span style="color: #AA22FF; font-weight: bold">in</span> chunks:
        <span style="color: #008000; font-weight: bold">assert</span> chunk<span style="color: #666666">.</span>count(<span style="color: #BA2121">&quot;```&quot;</span>) <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #666666">0</span>, <span style="color: #666666">2</span>)
</code></pre>
    </div>
    <script src="static/toggle.js"></script>
</body>
</html>
