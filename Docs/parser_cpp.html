<!-- Generated by DocGen-LM -->
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>parser_cpp</title>
<link href="static/style.css" rel="stylesheet"/>
</head>
<body><a class="skip-link" href="#main-content">Skip to main content</a><header class="topbar"><button aria-label="Toggle navigation menu" id="sidebar-toggle">Menu</button><span class="topbar-title">parser_cpp</span></header>
<nav aria-label="Documentation navigation" class="sidebar">
<h2>Navigation</h2>
<ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><a href="cache.html">cache</a></li><li><a href="chunk_utils.html">chunk_utils</a></li><li><a href="docgenerator.html">docgenerator</a></li><li><a href="explaincode.html">explaincode</a></li><li><a href="gui_wrapper.html">gui_wrapper</a></li><li><a href="html_writer.html">html_writer</a></li><li><a href="llm_client.html">llm_client</a></li><li><a href="manual_utils.html">manual_utils</a></li><li><a href="parser_cpp.html">parser_cpp</a></li><li><a href="parser_java.html">parser_java</a></li><li><a href="parser_matlab.html">parser_matlab</a></li><li><a href="parser_python.html">parser_python</a></li><li><a href="retrofit_sidebar.html">retrofit_sidebar</a></li><li><a href="reviewer.html">reviewer</a></li><li><a href="sanitize_docs.html">sanitize_docs</a></li><li><a href="scanner.html">scanner</a></li><li><a href="setup.html">setup</a></li><li><a href="summarize_utils.html">summarize_utils</a></li><li><details><summary>tests</summary><ul><li><a href="test_cache.html">test_cache</a></li><li><a href="test_chunk_utils.html">test_chunk_utils</a></li><li><a href="test_docgenerator.html">test_docgenerator</a></li><li><a href="test_docgenerator_subclasses.html">test_docgenerator_subclasses</a></li><li><a href="test_explaincode.html">test_explaincode</a></li><li><a href="test_html_writer.html">test_html_writer</a></li><li><a href="test_integration.html">test_integration</a></li><li><a href="test_llm_client.html">test_llm_client</a></li><li><a href="test_manual_utils.html">test_manual_utils</a></li><li><a href="test_parser_cpp.html">test_parser_cpp</a></li><li><a href="test_parser_java.html">test_parser_java</a></li><li><a href="test_parser_matlab.html">test_parser_matlab</a></li><li><a href="test_parser_python.html">test_parser_python</a></li><li><a href="test_resume_progress.html">test_resume_progress</a></li><li><a href="test_retrofit_sidebar.html">test_retrofit_sidebar</a></li><li><a href="test_reviewer.html">test_reviewer</a></li><li><a href="test_sanitize_docs.html">test_sanitize_docs</a></li><li><a href="test_scanner.html">test_scanner</a></li></ul></details></li></ul>
</nav>
<main class="content" id="main-content" role="main">
<h1>parser_cpp</h1>
<p>Module implements a line-based parser for C++ source files to extract namespaces, classes, functions, and public variables. It processes comments and code blocks to build structured data containing documentation strings, source code snippets, and element signatures. The parser handles multi-line comments, class member access specifiers, and function signatures while maintaining compatibility with Python parsing structures. Functions include collecting preceding comments, extracting code blocks enclosed in braces, and parsing class bodies for public methods and variables. The main entry point reads a file, identifies top-level elements, and returns a dictionary with module documentation, class definitions, and function declarations.</p>
<h2>Functions</h2>
<h3 id="_get_preceding_comment">_get_preceding_comment(lines: List[str], idx: int) -&gt; str</h3>
<p>The function `_get_preceding_comment` collects contiguous comment lines that appear before a specified index in a list of code lines. It handles both single-line comments (starting with `//`) and multi-line comments (enclosed between `/*` and `*/`). The collected comments are returned as a single string, with each comment line separated by a newline. The function stops collecting when it encounters a non-comment line or reaches the beginning of the list. Empty lines are ignored unless they appear after actual comments, in which case they terminate the comment collection.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_get_preceding_comment</span>(lines: List[<span style="color: #008000">str</span>], idx: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">"""Collect contiguous comment lines appearing before ``idx``."""</span>

    comments: List[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []
    j <span style="color: #666666">=</span> idx <span style="color: #666666">-</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">while</span> j <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span>:
        line <span style="color: #666666">=</span> lines[j]<span style="color: #666666">.</span>strip()
        <span style="color: #008000; font-weight: bold">if</span> line<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">"//"</span>):
            comments<span style="color: #666666">.</span>insert(<span style="color: #666666">0</span>, line<span style="color: #666666">.</span>lstrip(<span style="color: #BA2121">"/ "</span>))
            j <span style="color: #666666">-=</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">continue</span>
        <span style="color: #008000; font-weight: bold">if</span> line<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">"*/"</span>):
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">"/*"</span> <span style="color: #AA22FF; font-weight: bold">in</span> line:
                comments<span style="color: #666666">.</span>insert(<span style="color: #666666">0</span>, line<span style="color: #666666">.</span>strip()<span style="color: #666666">.</span>lstrip(<span style="color: #BA2121">"/* "</span>)<span style="color: #666666">.</span>rstrip(<span style="color: #BA2121">"*/ "</span>))
                <span style="color: #008000; font-weight: bold">break</span>
            block: List[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []
            block<span style="color: #666666">.</span>insert(<span style="color: #666666">0</span>, line)
            j <span style="color: #666666">-=</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">while</span> j <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span> <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #BA2121">"/*"</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> lines[j]:
                block<span style="color: #666666">.</span>insert(<span style="color: #666666">0</span>, lines[j])
                j <span style="color: #666666">-=</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">if</span> j <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span>:
                block<span style="color: #666666">.</span>insert(<span style="color: #666666">0</span>, lines[j])
            cleaned <span style="color: #666666">=</span> [b<span style="color: #666666">.</span>strip()<span style="color: #666666">.</span>lstrip(<span style="color: #BA2121">"/* "</span>)<span style="color: #666666">.</span>rstrip(<span style="color: #BA2121">"*/ "</span>) <span style="color: #008000; font-weight: bold">for</span> b <span style="color: #AA22FF; font-weight: bold">in</span> block]
            comments <span style="color: #666666">=</span> cleaned <span style="color: #666666">+</span> comments
            <span style="color: #008000; font-weight: bold">break</span>
        <span style="color: #008000; font-weight: bold">if</span> line <span style="color: #666666">==</span> <span style="color: #BA2121">""</span>:
            <span style="color: #008000; font-weight: bold">if</span> comments:
                <span style="color: #008000; font-weight: bold">break</span>
            j <span style="color: #666666">-=</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">continue</span>
        <span style="color: #008000; font-weight: bold">break</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">"</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span><span style="color: #666666">.</span>join(c <span style="color: #008000; font-weight: bold">for</span> c <span style="color: #AA22FF; font-weight: bold">in</span> comments <span style="color: #008000; font-weight: bold">if</span> c)<span style="color: #666666">.</span>strip()
</code></pre>
<h3 id="_extract_block">_extract_block(lines: List[str], start: int) -&gt; Tuple[str, int]</h3>
<p>The function `_extract_block` extracts a contiguous block of text from a list of lines, starting at a specified index. It identifies the block by tracking the balance of curly braces `{` and `}`. The function returns the extracted text along with the index of the last line processed. The extraction continues until the brace count reaches zero, indicating the end of the block.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_extract_block</span>(lines: List[<span style="color: #008000">str</span>], start: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> Tuple[<span style="color: #008000">str</span>, <span style="color: #008000">int</span>]:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">"""Return text and ending index for block starting at ``start``."""</span>

    text_lines <span style="color: #666666">=</span> [lines[start]]
    brace <span style="color: #666666">=</span> lines[start]<span style="color: #666666">.</span>count(<span style="color: #BA2121">"{"</span>) <span style="color: #666666">-</span> lines[start]<span style="color: #666666">.</span>count(<span style="color: #BA2121">"}"</span>)
    i <span style="color: #666666">=</span> start <span style="color: #666666">+</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">while</span> i <span style="color: #666666">&lt;</span> <span style="color: #008000">len</span>(lines) <span style="color: #AA22FF; font-weight: bold">and</span> brace <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        line <span style="color: #666666">=</span> lines[i]
        text_lines<span style="color: #666666">.</span>append(line)
        brace <span style="color: #666666">+=</span> line<span style="color: #666666">.</span>count(<span style="color: #BA2121">"{"</span>) <span style="color: #666666">-</span> line<span style="color: #666666">.</span>count(<span style="color: #BA2121">"}"</span>)
        i <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">"</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">"</span><span style="color: #666666">.</span>join(text_lines), i <span style="color: #666666">-</span> <span style="color: #666666">1</span>
</code></pre>
<h3 id="_parse_class_body">_parse_class_body(lines: List[str], start: int, end: int) -&gt; Tuple[List[Dict[str, Any]], List[Dict[str, Any]]]</h3>
<p>The function `_parse_class_body` parses the body of a class definition from a list of source code lines and extracts public methods and variables. It takes a list of strings representing lines of code, along with start and end indices defining the range to parse. The function returns a tuple containing two lists: one for public methods and one for public variables.

For each line in the specified range, it tracks access level (public, protected, private) and processes lines accordingly. Public methods are identified by lines ending with `{` and containing parentheses, extracting their signature, name, preceding comment, and source block. Public variables are identified by lines ending with `;` and not containing parentheses, extracting their type, name, and preceding comment. The function uses helper functions `_get_preceding_comment` to retrieve documentation comments and `_extract_block` to extract method source code blocks.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_parse_class_body</span>(lines: List[<span style="color: #008000">str</span>], start: <span style="color: #008000">int</span>, end: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> Tuple[List[Dict[<span style="color: #008000">str</span>, Any]], List[Dict[<span style="color: #008000">str</span>, Any]]]:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">"""Parse class body and return lists of public methods and variables."""</span>

    methods: List[Dict[<span style="color: #008000">str</span>, Any]] <span style="color: #666666">=</span> []
    variables: List[Dict[<span style="color: #008000">str</span>, Any]] <span style="color: #666666">=</span> []
    access <span style="color: #666666">=</span> <span style="color: #BA2121">"private"</span>
    i <span style="color: #666666">=</span> start
    <span style="color: #008000; font-weight: bold">while</span> i <span style="color: #666666">&lt;=</span> end:
        line <span style="color: #666666">=</span> lines[i]<span style="color: #666666">.</span>strip()
        <span style="color: #008000; font-weight: bold">if</span> line <span style="color: #AA22FF; font-weight: bold">in</span> {<span style="color: #BA2121">"public:"</span>, <span style="color: #BA2121">"protected:"</span>, <span style="color: #BA2121">"private:"</span>}:
            access <span style="color: #666666">=</span> line<span style="color: #666666">.</span>rstrip(<span style="color: #BA2121">":"</span>)
            i <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">continue</span>
        <span style="color: #008000; font-weight: bold">if</span> access <span style="color: #666666">==</span> <span style="color: #BA2121">"public"</span>:
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">"("</span> <span style="color: #AA22FF; font-weight: bold">in</span> line <span style="color: #AA22FF; font-weight: bold">and</span> line<span style="color: #666666">.</span>rstrip()<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">"{"</span>):
                sig <span style="color: #666666">=</span> line<span style="color: #666666">.</span>rstrip(<span style="color: #BA2121">"{"</span>)<span style="color: #666666">.</span>strip()
                name <span style="color: #666666">=</span> sig<span style="color: #666666">.</span>split(<span style="color: #BA2121">"("</span>)[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>split()[<span style="color: #666666">-1</span>]
                doc <span style="color: #666666">=</span> _get_preceding_comment(lines, i)
                block, end_idx <span style="color: #666666">=</span> _extract_block(lines, i)
                methods<span style="color: #666666">.</span>append({<span style="color: #BA2121">"name"</span>: name, <span style="color: #BA2121">"signature"</span>: sig, <span style="color: #BA2121">"docstring"</span>: doc, <span style="color: #BA2121">"source"</span>: block})
                i <span style="color: #666666">=</span> end_idx <span style="color: #666666">+</span> <span style="color: #666666">1</span>
                <span style="color: #008000; font-weight: bold">continue</span>
            <span style="color: #008000; font-weight: bold">if</span> line<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">";"</span>) <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #BA2121">"("</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> line:
                parts <span style="color: #666666">=</span> line<span style="color: #666666">.</span>rstrip(<span style="color: #BA2121">";"</span>)<span style="color: #666666">.</span>split()
                <span style="color: #008000; font-weight: bold">if</span> parts:
                    name <span style="color: #666666">=</span> parts[<span style="color: #666666">-1</span>]
                    vartype <span style="color: #666666">=</span> <span style="color: #BA2121">" "</span><span style="color: #666666">.</span>join(parts[:<span style="color: #666666">-1</span>])
                    doc <span style="color: #666666">=</span> _get_preceding_comment(lines, i)
                    variables<span style="color: #666666">.</span>append({<span style="color: #BA2121">"name"</span>: name, <span style="color: #BA2121">"type"</span>: vartype, <span style="color: #BA2121">"docstring"</span>: doc, <span style="color: #BA2121">"source"</span>: lines[i]})
        i <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">return</span> methods, variables
</code></pre>
<h3 id="parse_cpp_file">parse_cpp_file(path: str) -&gt; Dict[str, Any]</h3>
<p>The function `parse_cpp_file` reads and parses a C++ source file, extracting structured information about the file's contents. It identifies the module-level comment, namespaces, classes (including their methods and variables), and functions. The function processes the file line by line, using helper functions to extract comments, block structures, and class bodies. The result is a dictionary containing the module documentation string, lists of classes with their details, and a list of functions with their signatures and documentation. If a namespace is found, it is included in the returned dictionary.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">parse_cpp_file</span>(path: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> Dict[<span style="color: #008000">str</span>, Any]:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">"""Parse a C++ source file and return structured information."""</span>

    text <span style="color: #666666">=</span> Path(path)<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">"utf-8"</span>)
    lines <span style="color: #666666">=</span> text<span style="color: #666666">.</span>splitlines()

    <span style="color: #3D7B7B; font-style: italic"># Module-level comment</span>
    first_code <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">while</span> first_code <span style="color: #666666">&lt;</span> <span style="color: #008000">len</span>(lines):
        stripped <span style="color: #666666">=</span> lines[first_code]<span style="color: #666666">.</span>strip()
        <span style="color: #008000; font-weight: bold">if</span> stripped <span style="color: #666666">==</span> <span style="color: #BA2121">""</span> <span style="color: #AA22FF; font-weight: bold">or</span> stripped<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">"//"</span>) <span style="color: #AA22FF; font-weight: bold">or</span> stripped<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">"/*"</span>):
            first_code <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">continue</span>
        <span style="color: #008000; font-weight: bold">break</span>
    module_docstring <span style="color: #666666">=</span> _get_preceding_comment(lines, first_code)

    namespace <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
    classes: List[Dict[<span style="color: #008000">str</span>, Any]] <span style="color: #666666">=</span> []
    functions: List[Dict[<span style="color: #008000">str</span>, Any]] <span style="color: #666666">=</span> []

    i <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">while</span> i <span style="color: #666666">&lt;</span> <span style="color: #008000">len</span>(lines):
        line <span style="color: #666666">=</span> lines[i]
        stripped <span style="color: #666666">=</span> line<span style="color: #666666">.</span>strip()
        <span style="color: #008000; font-weight: bold">if</span> namespace <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #AA22FF; font-weight: bold">and</span> stripped<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">"namespace "</span>):
            namespace <span style="color: #666666">=</span> stripped<span style="color: #666666">.</span>split()[<span style="color: #666666">1</span>]
            <span style="color: #008000; font-weight: bold">if</span> namespace<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">"{"</span>):
                namespace <span style="color: #666666">=</span> namespace[:<span style="color: #666666">-1</span>]
        <span style="color: #008000; font-weight: bold">if</span> stripped<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">"class "</span>) <span style="color: #AA22FF; font-weight: bold">or</span> stripped<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">"struct "</span>):
            name <span style="color: #666666">=</span> stripped<span style="color: #666666">.</span>split()[<span style="color: #666666">1</span>]
            <span style="color: #008000; font-weight: bold">if</span> name<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">"{"</span>):
                name <span style="color: #666666">=</span> name[:<span style="color: #666666">-1</span>]
            doc <span style="color: #666666">=</span> _get_preceding_comment(lines, i)
            block, end_idx <span style="color: #666666">=</span> _extract_block(lines, i)
            methods, variables <span style="color: #666666">=</span> _parse_class_body(lines, i <span style="color: #666666">+</span> <span style="color: #666666">1</span>, end_idx <span style="color: #666666">-</span> <span style="color: #666666">1</span>)
            classes<span style="color: #666666">.</span>append({<span style="color: #BA2121">"name"</span>: name, <span style="color: #BA2121">"docstring"</span>: doc, <span style="color: #BA2121">"methods"</span>: methods, <span style="color: #BA2121">"variables"</span>: variables, <span style="color: #BA2121">"source"</span>: block})
            i <span style="color: #666666">=</span> end_idx <span style="color: #666666">+</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">continue</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">"("</span> <span style="color: #AA22FF; font-weight: bold">in</span> stripped <span style="color: #AA22FF; font-weight: bold">and</span> stripped<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">"{"</span>) <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #AA22FF; font-weight: bold">not</span> stripped<span style="color: #666666">.</span>startswith((<span style="color: #BA2121">"if"</span>, <span style="color: #BA2121">"for"</span>, <span style="color: #BA2121">"while"</span>, <span style="color: #BA2121">"switch"</span>)) <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #BA2121">"class "</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> stripped <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #BA2121">"struct "</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> stripped:
            sig <span style="color: #666666">=</span> stripped<span style="color: #666666">.</span>rstrip(<span style="color: #BA2121">"{"</span>)<span style="color: #666666">.</span>strip()
            name <span style="color: #666666">=</span> sig<span style="color: #666666">.</span>split(<span style="color: #BA2121">"("</span>)[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>split()[<span style="color: #666666">-1</span>]
            doc <span style="color: #666666">=</span> _get_preceding_comment(lines, i)
            block, end_idx <span style="color: #666666">=</span> _extract_block(lines, i)
            functions<span style="color: #666666">.</span>append({<span style="color: #BA2121">"name"</span>: name, <span style="color: #BA2121">"signature"</span>: sig, <span style="color: #BA2121">"docstring"</span>: doc, <span style="color: #BA2121">"source"</span>: block})
            i <span style="color: #666666">=</span> end_idx <span style="color: #666666">+</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">continue</span>
        i <span style="color: #666666">+=</span> <span style="color: #666666">1</span>

    result: Dict[<span style="color: #008000">str</span>, Any] <span style="color: #666666">=</span> {<span style="color: #BA2121">"module_docstring"</span>: module_docstring, <span style="color: #BA2121">"classes"</span>: classes, <span style="color: #BA2121">"functions"</span>: functions}
    <span style="color: #008000; font-weight: bold">if</span> namespace:
        result[<span style="color: #BA2121">"namespace"</span>] <span style="color: #666666">=</span> namespace
    <span style="color: #008000; font-weight: bold">return</span> result
</code></pre>
</main>
<footer aria-label="Page footer" class="page-footer"><p>Generated documentation</p></footer><script src="static/toggle.js"></script>
</body>
</html>
